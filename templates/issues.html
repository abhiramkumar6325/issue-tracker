{% extends "base.html" %}
{% block content %}

<h2>All Issues</h2>

<form method="get" style="display:flex; gap:10px; margin-bottom:20px;">
    <select name="status">
        <option value="">All Status</option>
        <option value="To Do" {% if status=="To Do" %}selected{% endif %}>To Do</option>
        <option value="In Progress" {% if status=="In Progress" %}selected{% endif %}>In Progress</option>
        <option value="Done" {% if status=="Done" %}selected{% endif %}>Done</option>
    </select>

    <select name="priority">
        <option value="">All Priority</option>
        <option value="Low" {% if priority=="Low" %}selected{% endif %}>Low</option>
        <option value="Medium" {% if priority=="Medium" %}selected{% endif %}>Medium</option>
        <option value="High" {% if priority=="High" %}selected{% endif %}>High</option>
    </select>

    <button type="submit">Filter</button>
</form>

<table>
<tr>
    <th>ID</th>
    <th>Problem</th>
    <th>Status</th>
    <th>Priority</th>
    <th>Module</th>
    <th>Product</th>
</tr>

{% for r in rows %}
<tr class="issue-row" data-id="{{ r.id }}">
    <td>{{ r.id }}</td>
    <td>{{ r.description }}</td>
    <td>
        <span class="status {{ r.status|lower|replace(' ', '') }}">
            {{ r.status }}
        </span>
    </td>
    <td>
        <span class="priority {{ r.priority|lower }}">
            {{ r.priority }}
        </span>
    </td>
    <td>{{ r.module }}</td>
    <td>{{ r.product }}</td>
</tr>
{% endfor %}
</table>

<script>
document.querySelectorAll(".issue-row").forEach(row => {
    row.addEventListener("click", function(){
        let id = this.getAttribute("data-id");
        window.location = "/issue/" + id;
    });
});
</script>

{% endblock %}
